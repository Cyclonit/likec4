import { defaultTheme } from '@likec4/core/dist/colors.js'
import { writeFileSync } from 'node:fs'
import { resolve, dirname } from 'node:path'

const colors = Object.keys(defaultTheme.colors)

const likec4 = `
// DO NOT EDIT MANUALLY
// Auto-generated by
//  $ yarn generate:c4:theme

specification {

  element themecolor
  element cylinder {
    style {
      shape cylinder
    }
  }
  element queue {
    style {
      shape queue
    }
  }
  element rect {
    style {
      shape rectangle
    }
  }
  element person {
    style {
      shape person
    }
  }
  element mobile {
    style {
      shape mobile
    }
  }
  element browser {
    style {
      shape browser
    }
  }
}
model {

  themecolor colors {
    title: 'Theme Colors'
    style {
      color gray
    }

${colors
  .map(
    key => `
    themecolor ${key} {
      title "${key}"

      cylinder = cylinder {
        title: 'Cylinder'
        description: 'Example of Cylinder Shape'
      }
      queue = queue {
        title: 'Queue'
        description: 'Example of Queue Shape'
      }
      mobile = mobile {
        title: 'Mobile'
        description: 'Example of Mobile Shape'
      }
      browser = browser {
        title: 'Browser'
        description: 'Example of Browser Shape'
      }
      person = person {
        title: 'Person'
        description: 'Example of Person Shape'
      }
      rect = rect {
        title: 'Rectangle'
        description: 'Example of Rectangle Shape'
      }
      person -> rect
      browser -> mobile
      cylinder -> queue
    }`
  )
  .join('')}
  }

  primary.rect -> blue.person
  blue.rect -> secondary.person
  secondary.rect -> sky.person
  sky.rect -> indigo.person

  muted.rect -> slate.person
  slate.rect -> gray.person

  red.rect -> green.person
  green.rect -> amber.person

}

views {

  view themecolors of colors {
    title "Theme Colors"

    include colors.*,${colors
      .map(
        key => `
      ${key}.*`
      )
      .join(',')}

${colors
  .map(
    key => `
    style ${key}, ${key}.* {
      color ${key}
    }`
  )
  .join('')}
  }

${colors
  .map(
    key => `
  view themecolor_${key} of ${key} {
    title "Theme Color: ${key}"
    include colors, ${key}, ${key}.*

    style * {
      color ${key}
    }
    style colors {
      color ${key != 'gray' ? 'gray' : 'slate'}
    }
  }
`
  )
  .join('')}

}
`

const __filename = new URL(import.meta.url).pathname
const __dirname = dirname(__filename)

const out = resolve(__dirname, '../src/stories/likec4/theme.c4')

writeFileSync(out, likec4)

console.log(`Generated ${out}`)
